<label id="lblLang">Language</label>
<select id="selLang">
    <option value="en">English</option>
    <option value="hi">हिन्दी</option>
    <option value="te">తెలుగు</option>
    <option value="ta">தமிழ்</option>
    <option value="kn">ಕನ್ನಡ</option>
    <option value="ml">മലയാളം</option>
    <option value="mr">मराठी</option>
    <option value="bn">বাংলা</option>
    <option value="gu">ગુજરાતી</option>
    <option value="pa">ਪੰਜਾਬੀ</option>
</select>

<label id="lblRegion">Region</label>
<select id="selRegion">
    <option value="ap">Andhra Pradesh</option>
    <option value="tg">Telangana</option>
    <option value="tn">Tamil Nadu</option>
    <option value="mh">Maharashtra</option>
    <option value="ka">Karnataka</option>
    <option value="kl">Kerala</option>
    <option value="gj">Gujarat</option>
    <option value="dl">Delhi</option>
    <option value="wb">West Bengal</option>
    <option value="generic">Generic India</option>
</select>

<div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
    <div class="badge" id="langBadge">EN</div>
    <button id="openAI" class="primary">Assistant</button>
</div>

<button id="btnAdd" class="primary">+ Add Appliance</button>
<button id="btnCalculate" class="primary">Calculate</button>
<button id="btnReset" class="danger">Reset</button>

<div class="card">
    <h3 id="applianceTitle">Appliance-wise Energy & Cost</h3>
    <div id="applianceList"></div>
</div>

<div class="card">
    <h3 id="summaryTitle">Summary & Suggestions</h3>
    <div id="summaryBox"></div>
    <div id="suggestBox" style="margin-top:8px"></div>
    <div id="tipsBox" class="tips"></div>
</div>

<img src="https://cdn-icons-png.flaticon.com/512/2913/2913465.png" alt="save"/>
<div>
    <div id="awTitle" style="font-weight:700">Save Electricity — Save Earth</div>
    <div id="awText" class="small">Turn off unused devices and prefer energy-efficient appliances.</div>
</div>

<div id="aiTitle">Energy Assistant</div>
<div style="cursor:pointer;" id="aiClose">✖</div>
<div class="msg-bot" id="aiWelcome">Hello — ask me about tariff slabs, how to save energy, or your bill calculation.</div>

<input id="aiInput" placeholder="Ask (e.g. 'What are Telangana slabs?')" />
<button id="aiSend">Send</button>

<script>
// Example slabs for demonstration
const slabs = {
    ap: [0, 100, 200, 300], // unit ranges
    tg: [0, 50, 150, 250],
    generic: [0, 100, 200, 300]
};

// Example prices per unit per slab
const prices = {
    ap: [3, 5, 8, 10],
    tg: [2.5, 4, 7, 9],
    generic: [3, 5, 8, 10]
};

// Function to calculate bill
function calculateBill(units, region) {
    const slabLimits = slabs[region] || slabs.generic;
    const slabPrices = prices[region] || prices.generic;
    let remaining = units;
    let cost = 0;
    let slabUsed = [];
    
    for (let i = 1; i < slabLimits.length; i++) {
        let slabUnits = Math.min(remaining, slabLimits[i] - slabLimits[i-1]);
        cost += slabUnits * slabPrices[i-1];
        slabUsed.push({ slab: i, units: slabUnits, rate: slabPrices[i-1], cost: slabUnits * slabPrices[i-1] });
        remaining -= slabUnits;
        if (remaining <= 0) break;
    }
    return { cost, slabUsed };
}

// Function to generate suggestions if exceeding 2 slabs
function generateSuggestions(units, region) {
    const slabLimits = slabs[region] || slabs.generic;
    if (units <= slabLimits[2]) return "You are within 2 slabs. Keep monitoring usage.";
    
    let suggestions = "⚠ You exceeded 2 slabs. To reach lower slabs:\n";
    const excess = units - slabLimits[2];
    suggestions += `- Reduce ${excess} units to fall into slab 2.\n`;
    suggestions += `- Try switching off high-energy appliances or use energy-efficient devices.\n`;
    return suggestions;
}

// Example integration
document.getElementById("btnCalculate").onclick = function() {
    const region = document.getElementById("selRegion").value;
    const totalUnits = parseInt(prompt("Enter total units consumed:")); // Simplified input
    const bill = calculateBill(totalUnits, region);
    
    // Show appliance-wise breakdown (simplified)
    let breakdownHTML = "";
    bill.slabUsed.forEach(s => {
        breakdownHTML += `<div>Slab ${s.slab}: ${s.units} units x ₹${s.rate} = ₹${s.cost}</div>`;
    });
    document.getElementById("applianceList").innerHTML = breakdownHTML;
    
    // Show total cost
    document.getElementById("summaryBox").innerHTML = `<b>Total Bill:</b> ₹${bill.cost}`;
    
    // Show suggestions
    document.getElementById("suggestBox").innerHTML = generateSuggestions(totalUnits, region).replace(/\n/g, "<br>");
};
</script>
